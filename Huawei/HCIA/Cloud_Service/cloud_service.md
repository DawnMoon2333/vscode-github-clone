# 第一章 云计算基础

## 基础知识

### 背景

传统IT面临的挑战：  

- 业务上线慢  
- 扩展困难  
  - 集中式架构扩展性低于分布式架构  
- 可靠性低  
- 生命周期管理复杂  
- IO瓶颈导致延迟  
- TCO居高不下  
  - Total Cost of Ownership：某项资产的全部成本，一般称为使用成本

企业IT基础设施架构演变：  

- 传统企业IT架构  
  - 服务器直接安装操作系统，软硬件存在强耦合关系，硬件资源利用率低，运维复杂  
- 虚拟化架构  
  - 软硬件解耦，资源利用率高  
- 企业云化IT架构  
  - 强调资源的整合与统一调度，架构从集中式转向分布式  

### 定义

云：  
- 互联网与建立互联网所需的底层基础设施的抽象体，即资源都在云端  

计算：  
- 性能强大的计算机提供的计算服务，包括资源、存储等  

云计算：  
- 用户通过互联网可以使用一台强大的计算器为自己服务，这种服务的使用量可以用统一的单位来描述。  

### 示例

云相册、云盘、视频会议、政务网上办事  

### 模式

部署模式：  
- 公有云  
  - 由云服务提供商搭建云基础设施，提供给个人或企业使用，有统一的架构、API、生态   
- 私有云  
  - 云数据中心部署于企业内部，所有数据保存于企业自己的云数据中心内。对所有数据的访问都需要经过数据中心的防火墙  
- 混合云
  - 公有云和私有云协同使用  

服务模式：  

IaaS：基础设施即服务  
- 由云平台提供基础设施及其维护，用户仅需关系基础设施资源之上的内容，如应用及其运行环境  
- ECS弹性云服务器、EVS云硬盘等  

PaaS：平台即服务  
- 由云平台提供基础设施和平台资源，用户仅需关注应用及其运行环境   

SaaS：软件即服务  
- 由云平台提供全部资源及其维护，用户可以直接使用  
- 人脸识别、语音转文本等  

|   种类   | 传统IT | IaaS | PaaS | SaaS |
|:------:|:------:|:----:|:----:|:----:|
|   应用   |   ×    |  ×   |  ×   |  √   |
|   数据   |   ×    |  ×   |  ×   |  √   |
| 运行环境 |   ×    |  ×   |  √   |  √   |
|  中间件  |   ×    |  ×   |  √   |  √   |
| 操作系统 |   ×    |  ×   |  √   |  √   |
|  虚拟化  |   ×    |  √   |  √   |  √   |
|  服务器  |   ×    |  √   |  √   |  √   |
|   存储   |   ×    |  √   |  √   |  √   |
|   网络   |   ×    |  √   |  √   |  √   |

> 用户侧管理：×   
> 云平台管理：√  

### 价值

- 按需自助服务  
- 广泛网络接入  
  - 无论何时何地，只要有网络就可以接入  
- 资源池化   
  - 资源池：云服务提供商将计算、存储和网络等资源集中管理，形成一个共享的资源库，供多个用户按需使用  
  - 资源池化：将这些资源虚拟化，使其能够动态分配和弹性伸缩，提高资源利用率和灵活性   
- 快速部署，弹性扩容  
- 可计量服务  
  - 使用的所有资源都可以被监控和计量并计费的  

### 通用点  

- 大规模  
- 同质化（标准化）  
- 虚拟化  
- 弹性计算  
  - 资源的快速供应和释放  
- 低成本软件  
- 先进安全技术  
- 地理分布  
- 面向服务  

## 基础技术

### 计算类技术

#### 虚拟化

将单台物理服务器虚拟为多台虚拟机，共享同一个物理服务器的硬件资源  

虚拟化的本质是将原先的物理设备逻辑化，转化为一个文件夹或文件，实现软硬件的解耦  

- 虚拟机由**磁盘文件**和**描述文件**组成，封装于同一个文件夹中  
- 多个虚拟机各自封装，互相隔离  

虚拟化是云计算的**核心技术**

虚拟化的特点：  

- 分区  
  - 虚拟化可以对资源进行划分，根据虚拟机的规格大小给虚拟机分配资源  
- 隔离  
  - 虚拟机和虚拟机之间是互相隔离的  
- 封装  
  - 虚拟机是以文件的形式存在的  
- 独立  
  - 即相对于硬件独立（软硬件解耦）  
  - 虚拟机跟硬件不存在绑定关系  

![alt text](images/virtual.png)

Hypervisor（Virtual Machine Monitor）：虚拟化软件层（虚拟机监视器）  

- 对下：将底层物理硬件虚拟化为虚拟硬件VHM（Virtual Hardware）  
- 对上：基于虚拟硬件创建虚拟机并对其管理监控  

身边的计算资源：CPU、GPU、内存、etc.  

计算在云服务中的服务形态：  

- ECS弹性服务器  
- AS弹性伸缩  
- IMS镜像服务  

#### 容器

一种操作系统级的虚拟化，是一个轻量级、可移植的软件打包技术，可以将**软件本体**及其**相关依赖**打包，使软件可以在任何计算介质中运行。  

容器技术的发展：  

- 1979：Chroot  
  - 修改进程的根目录，使进程只能看到其根目录下的文件，从而实现进程的隔离  
- 2008：LXC(Linux Containers)  
  - 基于Chroot技术，通过Cgroup、Namespace等技术实现进程、网络、文件系统等的隔离  
- 2013：Docker（容器引擎）  
  - 基于LXC，通过Dockerfile、Docker镜像、Docker容器等技术实现软件的打包和分发  

![alt text](images/docker_vs_virtual.png)
![alt text](images/differ_docker_vm.png)

容器和容器之间共享同一个操作系统，虚拟机和虚拟机之间是独立的操作系统   

容器在云计算中的服务形态：  

- CCE云容器引擎  
- CCI云容器实例   
  - 无服务器的容器服务，用户不需要创建和管理服务器集群就可以直接运行容器  
- 容器镜像服务  
  - 为容器实例提供镜像  

![alt text](images/docker.png)

### 网络类技术

#### 传统网络的基本概念

- 广播和单播  
  - 一台虚拟机将消息发送给网络中的所有虚拟器/对网络中的某一个特定的虚拟机进行一对一通信  
- 路由  
  - 即路由器，负责分析数据包的目标地址，决定最佳的传输路径，并将数据包转发到下一个网络节点  
- 网关  
  - 用于链接不同网络和协议的设备，允许局域网内的设备与外部网络（如互联网）进行通信  
  - 同一局域网内的通信可以使用MAC地址，不需要借助路由和网关  
  - 在有多个子网的大型局域网中仅需要路由器在不同子网中转发数据包，而不需要网关（前提是这些子网使用相同的网络协议）  
  - 访问外部网络时，需要网关转发数据包  
  - 路由器可以作为网关使用  
- VLAN虚拟局域网   
  - 将不同的网络设备划分到不同的虚拟局域网（逻辑子网）中，实现逻辑隔离。即使它们共享同一物理网络，它们之间的通信是隔离的   
  - VLAN跟地理位置无关，无论设备位于物理网络的哪个地方，只要它们被配置为同一VLAN，便可以相互通信  
  - 在同一VLAN中的通信不需要路由和网关，不同VLAN间的通信需要路由  

#### 传统网络包含的设备

- 路由器  
  - 
- 三层交换机  
- 二层交换机  
- 服务器网卡   
